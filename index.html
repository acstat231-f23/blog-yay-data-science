<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shani Getz, Yvan Grinspan, Daniel Jang">
<meta name="dcterms.date" content="2023-12-06">

<title>Sentiment Comparison Between Popular TV Shows</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="index_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro" id="toc-intro" class="nav-link active" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#text-analysis" id="toc-text-analysis" class="nav-link" data-scroll-target="#text-analysis">Text Analysis</a>
  <ul class="collapse">
  <li><a href="#faceting-formatting-of-most-common-words" id="toc-faceting-formatting-of-most-common-words" class="nav-link" data-scroll-target="#faceting-formatting-of-most-common-words">Faceting Formatting of Most Common Words</a></li>
  <li><a href="#by-top-5-characters" id="toc-by-top-5-characters" class="nav-link" data-scroll-target="#by-top-5-characters">By Top 5 Characters</a>
  <ul class="collapse">
  <li><a href="#gilmore-girls-1" id="toc-gilmore-girls-1" class="nav-link" data-scroll-target="#gilmore-girls-1">Gilmore Girls</a></li>
  <li><a href="#euphoria-1" id="toc-euphoria-1" class="nav-link" data-scroll-target="#euphoria-1">Euphoria</a></li>
  <li><a href="#south-park-1" id="toc-south-park-1" class="nav-link" data-scroll-target="#south-park-1">South Park</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#sentiment-analysis" id="toc-sentiment-analysis" class="nav-link" data-scroll-target="#sentiment-analysis">Sentiment Analysis</a>
  <ul class="collapse">
  <li><a href="#most-common-words-by-sentiment" id="toc-most-common-words-by-sentiment" class="nav-link" data-scroll-target="#most-common-words-by-sentiment">Most Common Words by Sentiment</a>
  <ul class="collapse">
  <li><a href="#euphoria-2" id="toc-euphoria-2" class="nav-link" data-scroll-target="#euphoria-2">Euphoria</a></li>
  <li><a href="#south-park-2" id="toc-south-park-2" class="nav-link" data-scroll-target="#south-park-2">South Park</a></li>
  </ul></li>
  <li><a href="#positivity-scores" id="toc-positivity-scores" class="nav-link" data-scroll-target="#positivity-scores">Positivity Scores</a></li>
  <li><a href="#categorical-sentiment-analysis" id="toc-categorical-sentiment-analysis" class="nav-link" data-scroll-target="#categorical-sentiment-analysis">Categorical Sentiment Analysis</a>
  <ul class="collapse">
  <li><a href="#euphoria-3" id="toc-euphoria-3" class="nav-link" data-scroll-target="#euphoria-3">Euphoria</a></li>
  <li><a href="#south-park-3" id="toc-south-park-3" class="nav-link" data-scroll-target="#south-park-3">South Park</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sentiment Comparison Between Popular TV Shows</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shani Getz, Yvan Grinspan, Daniel Jang </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 6, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="intro" class="level1">
<h1>Intro</h1>
<p>What makes a TV show popular? While that is a multifaceted question with no straightforward answer, we want to find similarities and differences between three vastly different and very successful TV shows (Gilmore Girls, Euphoria, South Park) to see what makes them so popular. To look into the “why,” we have done text and sentiment analysis of the scripts of these shows and contextualized these analyses with our own interpretations as to why these words and general sentiments might resonate with viewers. Having seen these shows, we are able to confirm whether the analyses accurately depict the essence and topics of the series. First, we had to webscrape these scripts and then we cleaned up the scripts and removed the stop words. We then performed the analyses to reach a conclusion about how and why such disparate TV shows are so appealing to the general public.</p>
<p>##Summaries of Each Show Here are summaries of each of the shows for context before we get into the visualizations and analyses!</p>
<p>###Gilmore Girls Gilmore Girls is a feel-good drama comedy series focused on the relationship between a young single mother and her teenage daughter and their lives in a small New England town in the late 90s/early 2000s. With quirky characters in this town and complex relationships with parents and extended family, Gilmore Girls follows this unique mother-daughter duo through academic, professional, romantic, and existential ups and downs. This show has a very characteristic tone, with a lot of pop culture references and speedy, witty banter in the dialogue. The sense of community, ambition, independence, and love has left a lasting effect on millions of viewers.</p>
<p>###Euphoria Euphoria is a teen drama series known for its graphic depiction of mature topics, especially sexual abuse and drug use, as well as its focus on cinematography and scoring. It follows the lives of Rue and her high-school classmates as they navigate a variety of challenges from self-confidence and sexuality issues to addiction, grief, and abuse. The show’s distinct visual style targets and portrays Gen Z in a way that has significantly influenced trends in fashion, makeup, and social media.</p>
<p>###South Park South Park is a sitcom infamous for its exploration on offensive and controversial topics in a satirical fashion. The show centers around four fourth-graders ((Eric) Cartman, Kyle, Stan, Kenny) and their adventures. (ADD REASON WHY IT’S POPULAR)</p>
</section>
<section id="text-analysis" class="level1">
<h1>Text Analysis</h1>
<p>EXPLAIN TEXT ANALYSIS PLAN</p>
<section id="faceting-formatting-of-most-common-words" class="level2">
<h2 class="anchored" data-anchor-id="faceting-formatting-of-most-common-words">Faceting Formatting of Most Common Words</h2>
<p>Here are the most common words in these three shows after removing the stop words (using the dplyr stop words data set and individually selected stop words that were not included in that data set).</p>
<!-- Begin columns environment -->
<div style="display: flex; font-size: large;">
<!-- Create a column -->
<section id="gilmore-girls" class="level3">
<h3 class="anchored" data-anchor-id="gilmore-girls">Gilmore Girls</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/faceted%20Most%20Common%20Words%20in%20Gilmore%20Girls-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<!-- Create another column (this one is just adding horizontal space to separate content) -->
<div>
<div class="horizontalgap" style="width:40px">

</div>
</div>
<!-- Create another column -->
<section id="euphoria" class="level3">
<h3 class="anchored" data-anchor-id="euphoria">Euphoria</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/faceted%20Most%20Common%20Words%20in%20Euphoria-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<div>
<div class="horizontalgap" style="width:40px">

</div>
</div>
<section id="south-park" class="level3">
<h3 class="anchored" data-anchor-id="south-park">South Park</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/faceted%20Most%20Common%20Words%20in%20South%20Park-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</div>
<!-- End columns environment with matching length indicator-->
</section>
<section id="by-top-5-characters" class="level2">
<h2 class="anchored" data-anchor-id="by-top-5-characters">By Top 5 Characters</h2>
<p>In each of these shows we narrowed down the characters to the top 5 (or 4) main characters that contribute the most to the dialogue or culture of the show. This shows the breakdown of the most common words seen above into the most common characters, highlighting their similarities and differences.</p>
<section id="gilmore-girls-1" class="level3">
<h3 class="anchored" data-anchor-id="gilmore-girls-1">Gilmore Girls</h3>
<p>The top 5 characters in Gilmore Girls: Lorelai and Rory, the mother and daughter duo. Luke, the owner of the town diner Lorelai and Rory frequent (and Lorelai’s future boyfriend/husband). Emily, Lorelai’s mother and Rory’s grandmother. Sookie, Lorelai’s best friend, the chef at the inn that they work at/run together.</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Gilmore%20Girls%20Most%20Common%20Words%20by%20Character%20Visualization-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Character</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Filtered Words</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Unfiltered Words</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">% of all Filtered words</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">% of all Unfiltered words</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lorelai</td>
<td style="text-align: right;">82981</td>
<td style="text-align: right;">82981</td>
<td style="text-align: right;">26.49</td>
<td style="text-align: right;">7.15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rory</td>
<td style="text-align: right;">46281</td>
<td style="text-align: right;">46281</td>
<td style="text-align: right;">14.78</td>
<td style="text-align: right;">3.99</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luke</td>
<td style="text-align: right;">21765</td>
<td style="text-align: right;">21765</td>
<td style="text-align: right;">6.95</td>
<td style="text-align: right;">1.88</td>
</tr>
<tr class="even">
<td style="text-align: left;">Emily</td>
<td style="text-align: right;">19464</td>
<td style="text-align: right;">19464</td>
<td style="text-align: right;">6.21</td>
<td style="text-align: right;">1.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sookie</td>
<td style="text-align: right;">12261</td>
<td style="text-align: right;">12261</td>
<td style="text-align: right;">3.91</td>
<td style="text-align: right;">1.06</td>
</tr>
</tbody>
</table>


</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Character</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Overall Mean of Sentiment Throughout the show</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Emily</td>
<td style="text-align: right;">0.419</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lorelai</td>
<td style="text-align: right;">0.203</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Luke</td>
<td style="text-align: right;">-0.190</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rory</td>
<td style="text-align: right;">0.187</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sookie</td>
<td style="text-align: right;">0.308</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="euphoria-1" class="level3">
<h3 class="anchored" data-anchor-id="euphoria-1">Euphoria</h3>
<p>EXPLAIN THE CHARACTERS</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Most%20Common%20Words%20by%20the%20Top%205%20Characters%20in%20Euphoria-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="south-park-1" class="level3">
<h3 class="anchored" data-anchor-id="south-park-1">South Park</h3>
<p>This is a bit different as in south park, we mainly revolve around these four characters (one of them barely speaks, but has a large cultural impact). So, this analysis is a bit different. BRIEFLY EXPLAIN THE OTHER CHARACTERS TOO?</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Sentiments%20Based%20on%20Main%20Character%20for%20South%20Park-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Character</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Overall Mean of Sentiment Throughout the show</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cartman</td>
<td style="text-align: right;">-0.630</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kenny</td>
<td style="text-align: right;">-1.058</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kyle</td>
<td style="text-align: right;">-0.842</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stan</td>
<td style="text-align: right;">-0.698</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="sentiment-analysis" class="level1">
<h1>Sentiment Analysis</h1>
<p>To implement the sentiment analysis, we used tidy text databases called AFINN and nrc that describe how postive/negative a word is with a score from -5 to 5 and associate a number of categorical sentiments like fear, trust, joy, anticipation, and anger with the same words, respectively. There are only 2,477 words that exist in this database and it cannot take into account context and tone, revealing this analysis’s limits, as well as potentially removing certain words we deemed not a stop word</p>
<section id="most-common-words-by-sentiment" class="level2">
<h2 class="anchored" data-anchor-id="most-common-words-by-sentiment">Most Common Words by Sentiment</h2>
<p>Instead of looking just at the most common words, we wanted to filter even more by dplyr’s sentiment package and look at the most common words that have an associated positivity value from the AFINN database. Using a color scale where green is postive and red is negative, we can reevaluate the recurring themes and topics in the shows.</p>
<p>###Gilmore Girls</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Most%20common%20words%20sentiment%20analysis%20in%20Gilmore%20girls-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="euphoria-2" class="level3">
<h3 class="anchored" data-anchor-id="euphoria-2">Euphoria</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Most%20common%20words%20positivity%20rating%20in%20Euphoria-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="south-park-2" class="level3">
<h3 class="anchored" data-anchor-id="south-park-2">South Park</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Most%20common%20words%20sentiment%20analysis%20in%20South%20Park-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="positivity-scores" class="level2">
<h2 class="anchored" data-anchor-id="positivity-scores">Positivity Scores</h2>
<p>EXPLAIN POSITIVITY SCORES</p>
<div class="cell" data-layout-align="left">
<div class="cell-output cell-output-stdout">
<pre><code>The mean positivity value of Gilmore Girls is 0.2181001</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean positivity value of Euphoria is -1.372624</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>The mean positivity value of South Park is -0.5185825</code></pre>
</div>
</div>
</section>
<section id="categorical-sentiment-analysis" class="level2">
<h2 class="anchored" data-anchor-id="categorical-sentiment-analysis">Categorical Sentiment Analysis</h2>
<p>EXPLAIN OUR categorical SENTIMENT ANALYSIS</p>
<p>###Gilmore Girls</p>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Gilmore%20Girls%20categorical%20Sentiment%20Analysis%20Visualization-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="euphoria-3" class="level3">
<h3 class="anchored" data-anchor-id="euphoria-3">Euphoria</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/Euphoria%20categorical%20Sentiment%20Analysis%20Visualization-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="south-park-3" class="level3">
<h3 class="anchored" data-anchor-id="south-park-3">South Park</h3>
<div class="cell" data-layout-align="left">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="index_files/figure-html/South%20Park%20categorical%20Sentiment%20Analysis%20Visualization-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Character</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Filtered Words</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Unfiltered Words</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">% of all Filtered words</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">% of all Unfiltered words</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cartman</td>
<td style="text-align: right;">43869</td>
<td style="text-align: right;">140919</td>
<td style="text-align: right;">15.43</td>
<td style="text-align: right;">15.55</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kenny</td>
<td style="text-align: right;">1430</td>
<td style="text-align: right;">4461</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kyle</td>
<td style="text-align: right;">18986</td>
<td style="text-align: right;">67360</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">7.43</td>
</tr>
<tr class="even">
<td style="text-align: left;">Stan</td>
<td style="text-align: right;">19767</td>
<td style="text-align: right;">69018</td>
<td style="text-align: right;">6.95</td>
<td style="text-align: right;">7.61</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>#Analysis and Conclusion</p>
<p>##Analysis Talk specifics, values, words</p>
<p>##Conclusion big takeaways, what do people like, why do they like it? where do we move from here? if we were to continue use new sentiment analysis database to get more accurate analyses/values/visualizations?</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>